<form class="{{cssClass}}" autocomplete="off">
    <header>
        <section>
            <div>
                <img src="{{actor.img}}" data-edit="img" title="{{actor.name}}" height="92" width="92" />
            </div>
            <div class="details">
                <h1>
                    <input name="name" type="text" value="{{actor.name}}"
                        placeholder="{{localize 'splittermond.name' }}" />
                </h1>
                <div class="description">
                    <input class="autoexpand" name="data.type" type="text" value="{{data.type}}"
                        placeholder="{{localize 'splittermond.opponenttype'}}" />&nbsp;&middot;&nbsp;
                    <input class="autoexpand" name="data.level" type="text" value="{{data.level}}"
                        placeholder="{{localize 'splittermond.opponentlevel'}}" />&nbsp;&middot;&nbsp;
                    <input class="autoexpand" name="data.sex" type="text" value="{{data.sex}}"
                        placeholder="{{localize 'splittermond.sex'}}" />

                </div>

                <ul class="npcfeatures taglist" data-item-type="npcfeature">
                    {{#each itemsByType.npcfeature}}
                    <li class="item" data-item-id="{{this._id}}">
                        <div class="name"><a data-action="edit-item" class="tooltip-activator">{{this.name}}</a>
                            <div class="tooltip">
                                {{{this.data.description}}}
                            </div>
                        </div>


                        <div class="actions">
                            <button class="button-inline" data-action="delete-item" type="button">
                                <i class="fa fa-trash" aria-hidden="true"></i>
                            </button>
                        </div>
                    </li>
                    {{/each}}
                    <li class="actions"><button class="button-inline" type="button" data-action="add-item"
                            data-render-sheet="true">
                            <i class="fa fa-plus-square" aria-hidden="true"></i>
                        </button></li>
                </ul>
            </div>
        </section>

        <section>
            {{> "systems/splittermond/templates/sheets/actor/parts/attribute-input.hbs" attributes=data.attributes
            derivedAttributes=data.derivedAttributes}}
            {{> "systems/splittermond/templates/sheets/actor/parts/focus-health.hbs" focus=data.focus
            health=data.health}}
        </section>
    </header>
    <nav class="sheet-navigation tabs" data-group="primary">
        <a class="item" data-tab="general">{{ localize "splittermond.general" }}</a>
        <a class="item" data-tab="spells">{{ localize "splittermond.spells" }}</a>
        <a class="item" data-tab="inventory">{{ localize "splittermond.inventory" }}</a>
        <a class="item" data-tab="status">{{ localize "splittermond.status" }}</a>
    </nav>
    <main class="tab-list">
        <section class="tab general" data-group="primary" data-tab="general">
            <div data-roll-type="skill">
                <div class="list skills">
                    <div class="list-header">
                        <h3>{{localize "splittermond.generalSkills"}}</h3>
                        <div class="actions">
                            <button class="button-inline" data-action="show-hide-skills" type="button">
                                {{#if hideSkills}}
                                <i class="fa fa-eye" aria-hidden="true"></i>
                                {{else}}
                                <i class="fa fa-eye-slash" aria-hidden="true"></i>
                                {{/if}}
                            </button>
                        </div>
                    </div>
                    <ol class="skill-list">
                        {{#each data.generalSkills as |skill skillId|}}
                        {{#if skill.isVisible}}
                        <li class="draggable" data-skill="{{skillId}}">
                            <label>
                                <a class="rollable">
                                    {{localize skill.label}}
                                </a>
                            </label>
                            <div class="value tooltip-activator">
                                <input name="data.skills.{{skillId}}.value" type="text" value="{{skill.value}}"
                                    data-dtype="Number">
                                {{#if skill.bonus}}
                                <div class="tooltip">
                                    {{#each skill.bonus.equipment}}
                                    <label>{{this.description}}</label>
                                    <div class="value">{{this.value}}</div>
                                    {{/each}}
                                    {{#each skill.bonus.magic}}
                                    <label>{{this.description}}</label>
                                    <div class="value">{{this.value}}</div>
                                    {{/each}}
                                    {{#each skill.bonus.misc}}
                                    <label>{{this.description}}</label>
                                    <div class="value">{{this.value}}</div>
                                    {{/each}}
                                    {{#each skill.malus.all}}
                                    <label>{{this.description}}</label>
                                    <div class="value">{{this.value}}</div>
                                    {{/each}}
                                </div>
                                {{/if}}
                            </div>


                        </li>
                        {{/if}}
                        {{/each}}
                    </ol>
                </div>
                <div class="list skills">
                    <div class="list-header">
                        <h3>{{localize "splittermond.magicSkills"}}</h3>
                        <div class="actions">
                            <button class="button-inline" data-action="show-hide-skills" type="button">
                                {{#if hideSkills}}
                                <i class="fa fa-eye" aria-hidden="true"></i>
                                {{else}}
                                <i class="fa fa-eye-slash" aria-hidden="true"></i>
                                {{/if}}
                            </button>
                        </div>
                    </div>
                    <ol class="skill-list">
                        {{#each data.magicSkills as |skill skillId|}}
                        {{#if skill.isVisible}}
                        <li class="draggable" data-skill="{{skillId}}">
                            <label>
                                <a class="rollable">{{localize skill.label}}</a>
                            </label>
                            <div class="value tooltip-activator"><input name="data.skills.{{skillId}}.value" type="text"
                                    value="{{skill.value}}" data-dtype="Number">
                                {{#if skill.bonus}}
                                <div class="tooltip">
                                    {{#each skill.bonus.equipment}}
                                    <label>{{this.description}}</label>
                                    <div class="value">{{this.value}}</div>
                                    {{/each}}
                                    {{#each skill.bonus.magic}}
                                    <label>{{this.description}}</label>
                                    <div class="value">{{this.value}}</div>
                                    {{/each}}
                                    {{#each skill.bonus.misc}}
                                    <label>{{this.description}}</label>
                                    <div class="value">{{this.value}}</div>
                                    {{/each}}
                                    {{#each skill.malus.all}}
                                    <label>{{this.description}}</label>
                                    <div class="value">{{this.value}}</div>
                                    {{/each}}
                                </div>
                                {{/if}}
                            </div>
                        </li>
                        {{/if}}
                        {{/each}}
                    </ol>
                </div>
            </div>

            <div>
                <div>
                    <div class="tabs" data-group="fight-action-type">
                        <a class="item active" data-group="fight-action-type" data-tab="attack">{{ localize
                            "splittermond.attack" }}</a>
                        <a class="item" data-group="fight-action-type" data-tab="defense">{{ localize
                            "splittermond.activeDefense"
                            }}</a>
                    </div>
                    <div class="tab-list">
                        <div class="tab" data-tab="attack" data-group="fight-action-type">
                            <div class="list attack" data-roll-type="attack">
                                <div class="list-header">
                                    <h3>{{localize "splittermond.weapons"}}</h3>
                                    <div class="value">{{localize "splittermond.skillValueAbbrev"}}</div>
                                    <div class="damage">{{localize "splittermond.damage"}}</div>
                                    <div class="range">{{localize "splittermond.rangeAbbrev"}}</div>
                                    <div class="weapon-speed">{{localize "splittermond.weaponSpeedAbbrev"}}</div>
                                    <div class="features" title="{{this.data.features}}">{{localize
                                        "splittermond.features"}}
                                    </div>
                                </div>
                                <ol>
                                    {{#each itemsByType.weapon}}
                                    {{#if this.data.equipped}}
                                    <li class="draggable" data-item-id="{{this._id}}">
                                        <img width="32" height="32" src="{{{this.img}}}">
                                        <label>
                                            <a class="rollable">{{localize this.name}}</a>
                                        </label>
                                        <div class="value"><input name="data.skills.{{this.data.skill}}.value"
                                                type="text" value="{{this.data.skillValue}}" data-dtype="Number"
                                                data-skill-value="{{this.data.skillValue}}" /></div>
                                        <div class="damage">
                                            <a class="rollable" data-roll-type="damage"
                                                data-damage="{{this.data.damage}}"
                                                data-features="{{this.data.features}}">{{this.data.damage}}</a>
                                        </div>
                                        <div class="range">{{this.data.range}}</div>
                                        <div class="weapon-speed">
                                            <a class="add-tick" data-ticks="{{this.data.weaponSpeed}}"
                                                data-message="{{localize 'splittermond.attack'}}: {{this.name}}">
                                                {{this.data.weaponSpeed}}
                                            </a>
                                        </div>
                                        <div class="features" title="{{this.data.features}}">{{this.data.features}}
                                        </div>
                                    </li>
                                    {{/if}}
                                    {{/each}}
                                </ol>
                            </div>
                        </div>
                        <div class="tab active" data-tab="defense" data-group="fight-action-type">
                            <div class="list active-defense" data-roll-type="activeDefense">
                                <div class="list-header">
                                    <h3>{{localize "splittermond.derivedAttribute.defense.long"}}</h3>
                                    <div class="value">{{localize "splittermond.skillValueAbbrev"}}</div>
                                    <div class="features" title="{{this.data.features}}">{{localize
                                        "splittermond.features"}}
                                    </div>
                                </div>
                                <ol data-defense-type="defense">
                                    {{#each data.activeDefense.defense}}
                                    <li data-item-id="{{this._id}}">
                                        {{#if this.img}}
                                        <img width="32" height="32" src="{{{this.img}}}">
                                        {{/if}}
                                        <label>
                                            <a class="rollable">{{localize this.name}}</a>
                                        </label>
                                        <div class="value"><input class="autoexpand"
                                                name="data.skills.{{this.data.skill}}.value" type="text"
                                                value="{{this.data.skillValue}}" data-dtype="Number"
                                                data-skill-value="{{this.data.skillValue}}" /></div>
                                        <div class="features" title="{{this.data.features}}">{{this.data.features}}
                                        </div>
                                    </li>
                                    {{/each}}
                                </ol>
                                <div class="list-header">
                                    <h3>{{localize "splittermond.derivedAttribute.mindresist.long"}}</h3>
                                    <div class="value">{{localize "splittermond.skillValueAbbrev"}}</div>
                                </div>
                                <ol data-defense-type="mindresist">
                                    {{#each data.activeDefense.mindresist}}
                                    <li data-item-id="{{this._id}}">
                                        {{#if this.img}}
                                        <img width="32" height="32" src="{{{this.img}}}">
                                        {{/if}}
                                        <label>
                                            <a class="rollable">{{localize this.name}}</a>
                                        </label>
                                        <div class="value">{{this.data.skillValue}}</div>
                                    </li>
                                    {{/each}}
                                </ol>
                                <div class="list-header">
                                    <h3>{{localize "splittermond.derivedAttribute.bodyresist.long"}}</h3>
                                    <div class="value">{{localize "splittermond.skillValueAbbrev"}}</div>
                                </div>
                                <ol data-defense-type="bodyresist">
                                    {{#each data.activeDefense.bodyresist}}
                                    <li data-item-id="{{this._id}}">
                                        {{#if this.img}}
                                        <img width="32" height="32" src="{{{this.img}}}">
                                        {{/if}}
                                        <label>
                                            <a class="rollable">{{localize this.name}}</a>
                                        </label>
                                        <div class="value">{{this.data.skillValue}}</div>
                                    </li>
                                    {{/each}}
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>
                {{> "systems/splittermond/templates/sheets/actor/parts/mastery-list.hbs"
                masteriesBySkill=masteriesBySkill}}
                <!--
                <div class="list masteries">
                    <div class="list-header">
                        <h3>{{localize "splittermond.masteries"}}</h3>
                    </div>
                    <ol class="mastery-list">
                        {{#each masteriesBySkill}}
                        <li><label>{{localize this.label}}</label>
                            <ol class="taglist">
                                {{#each this.masteries}}
                                <li class="tooltip-activator" data-item-id="{{this._id}}">
                                    <div class="name"><a class="tooltip-activator"
                                            data-action="edit-item">{{this.name}}</a>
                                        <div class="tooltip">{{{this.data.description}}}</div>
                                    </div>

                                    <div class="actions">
                                        <button class="button-inline" type="button" data-action="delete-item">
                                            <i class="fa fa-trash" aria-hidden="true"></i>
                                        </button>
                                    </div>
                                </li>
                                {{/each}}
                            </ol>
                        </li>
                        {{/each}}
                    </ol>

                </div>
                -->
            </div>

        </section>
        <section class="tab spells" data-group="primary" data-tab="spells">
            <div>
                <div class="list channeled-spells">
                    <div class="list-header">
                        <h3>{{localize "splittermond.channeledSpells"}}</h3>
                        <div class="actions">
                            <button class="button-inline" type="button" data-action="add-channeled-focus"
                                data-render-sheet="0">
                                <i class="fa fa-plus-square" aria-hidden="true"></i>
                            </button>
                        </div>
                    </div>
                    <ol data-array="data.focus.channeled.entries">
                        {{#each data.focus.channeled.entries}}
                        <li data-index="{{@index}}">
                            <input data-array-field="description" type="text" value="{{this.description}}">

                            <div class="costs"><input data-array-field="costs" type="text" value="{{this.costs}}"
                                    data-dtype="Number"></div>
                            <div class="actions">
                                <button class="button-inline" type="button" data-action="delete-array-element">
                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                </button>
                            </div>
                        </li>
                        {{/each}}
                    </ol>
                </div>

                <div class="list spells" data-item-type="spell" data-roll-type="spell">

                    {{#each spellsBySkill}}
                    <div class="list-header">
                        <h3>{{localize this.label}} ({{this.skillValue}})</h3>
                        <div class="difficulty">{{localize "splittermond.difficultyAbbrev"}}</div>
                        <div class="costs">{{localize "splittermond.focusCostsAbbrev"}}</div>
                        <div class="cast-duration">{{localize "splittermond.castDurationAbbrev"}}</div>
                        <div class="range">{{localize "splittermond.rangeAbbrev"}}</div>
                        <div class="effect-duration">{{localize "splittermond.effectDurationAbbrev"}}</div>
                        <div class="actions">
                            <button class="button-inline" type="button" data-action="add-item"><i
                                    class="fa fa-plus-square" aria-hidden="true"></i></button>
                        </div>
                    </div>
                    <ol>
                        {{#each this.spells}}
                        <li class="draggable {{#if this.enoughFocus}}available{{else}}not-available{{/if}}"
                            data-item-id="{{this._id}}">
                            <label>
                                <a class="rollable">{{localize this.name}}</a>
                            </label>
                            <div class="description">{{{this.data.description}}}</div>
                            <div class="difficulty">{{this.data.difficulty}}</div>
                            <div class="costs" data-type="focus" data-description="{{this.name}}">
                                <a class="consume" data-value="{{this.data.costs}}">{{this.data.costs}}</a>
                                (<a class="consume"
                                    data-description="{{this.name}} - {{localize 'splittermond.enhancementCosts'}}"
                                    data-value="{{this.data.enhancementCosts}}">{{this.data.enhancementCosts}}</a>)
                            </div>
                            <div class="cast-duration">
                                <a class="add-tick" data-ticks="{{this.data.castDuration}}" data-message="{{localize "
                                    splittermond.castDuration"}}: {{this.name}}">
                                    {{this.data.castDuration}}
                                </a>
                            </div>
                            <div class="range">{{this.data.range}}</div>
                            <div class="effect-duration">{{this.data.effectDuration}}</div>
                            <div class="actions">
                                <button class="button-inline" type="button" data-action="edit-item">
                                    <i class="fa fa-edit" aria-hidden="true"></i>
                                </button>
                                <button class="button-inline" type="button" data-action="delete-item">
                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                </button>
                            </div>
                        </li>
                        {{/each}}
                    </ol>
                    {{/each}}
                </div>
            </div>
        </section>
        <section class="tab inventory" data-group="primary" data-tab="inventory">
            <div>
                <div class="list inventory" data-item-type="weapon">
                    <div class="list-header">
                        <h3>{{localize "splittermond.weapons"}}</h3>
                        <div class="damage">{{localize "splittermond.damage"}}</div>
                        <div class="range">{{localize "splittermond.rangeAbbrev"}}</div>
                        <div class="weapon-speed">{{localize "splittermond.weaponSpeedAbbrev"}}</div>
                        <div class="features" title="{{this.data.features}}">{{localize "splittermond.features"}}</div>
                        <div class="load">{{localize "splittermond.load"}}</div>
                        <div class="actions">
                            <button class="button-inline" type="button" data-action="add-item">
                                <i class="fa fa-plus-square" aria-hidden="true"></i>
                            </button>
                        </div>
                    </div>
                    <ol>
                        {{#each itemsByType.weapon}}
                        {{#if this.inInventory}}
                        <li class="draggable" data-item-id="{{this._id}}">
                            <img width="32" height="32" src="{{{this.img}}}">
                            <label>{{this.name}} <button class="button-inline" type="button"
                                    data-action="toggle-equipped">
                                    <i class="fa {{#if this.data.equipped}}fa-toggle-on{{else}}fa-toggle-off{{/if}}"
                                        aria-hidden="true"></i>
                                </button></label>
                            <div class="damage">{{this.data.damage}}</div>
                            <div class="range">{{this.data.range}}</div>
                            <div class="weapon-speed">{{this.data.weaponSpeed}}</div>
                            <div class="features" title="{{this.data.features}}">{{this.data.features}}</div>
                            <div class="load">{{this.data.weight}}</div>
                            <div class="actions">
                                <button class="button-inline" type="button" data-action="edit-item">
                                    <i class="fa fa-edit" aria-hidden="true"></i>
                                </button>
                                <button class="button-inline" type="button" data-action="delete-item">
                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                </button>
                            </div>
                        </li>
                        {{/if}}
                        {{/each}}
                    </ol>
                </div>
                <div class="list inventory" data-item-type="armor">
                    <div class="list-header">
                        <h3>{{localize "splittermond.armors"}}</h3>
                        <div class="damage-reduction">{{localize "splittermond.damageReductionAbbrev"}}</div>
                        <div class="defense-bonus">{{localize "splittermond.defenseBonus"}}</div>
                        <div class="tick-malus">{{localize "splittermond.tickMalus"}}</div>
                        <div class="handicap">{{localize "splittermond.handicapAbbrev"}}</div>
                        <div class="features" title="{{this.data.features}}">{{localize "splittermond.features"}}</div>
                        <div class="load">{{localize "splittermond.load"}}</div>
                        <div class="actions">
                            <button class="button-inline" type="button" data-action="add-item">
                                <i class="fa fa-plus-square" aria-hidden="true"></i>
                            </button>
                        </div>
                    </div>
                    <ol>
                        {{#each itemsByType.armor}}
                        <li class="draggable" data-item-id="{{this._id}}">
                            <img width="32" height="32" src="{{{this.img}}}">
                            <label>{{this.name}} <button class="button-inline" type="button"
                                    data-action="toggle-equipped">
                                    <i class="fa {{#if this.data.equipped}}fa-toggle-on{{else}}fa-toggle-off{{/if}}"
                                        aria-hidden="true"></i>
                                </button></label>
                            <div class="damage-reduction">{{this.data.damageReduction}}</div>
                            <div class="defense-bonus">{{this.data.defenseBonus}}</div>
                            <div class="tick-malus">{{this.data.tickMalus}}</div>
                            <div class="handicap">{{this.data.handicap}}</div>
                            <div class="features">{{this.data.features}}</div>
                            <div class="load">{{this.data.load}}</div>
                            <div class="actions">

                                <button class="button-inline" type="button" data-action="edit-item">
                                    <i class="fa fa-edit" aria-hidden="true"></i>
                                </button>
                                <button class="button-inline" type="button" data-action="delete-item">
                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                </button>
                            </div>
                        </li>
                        {{/each}}
                    </ol>
                </div>
                <div class="list inventory" data-item-type="shield">
                    <div class="list-header">
                        <h3>{{localize "splittermond.shields"}}</h3>
                        <div class="defense-bonus">{{localize "splittermond.defenseBonus"}}</div>
                        <div class="tick-malus">{{localize "splittermond.tickMalus"}}</div>
                        <div class="handicap">{{localize "splittermond.handicapAbbrev"}}</div>
                        <div class="features">{{localize "splittermond.features"}}</div>
                        <div class="load">{{localize "splittermond.load"}}</div>
                        <div class="actions">

                            <button class="button-inline" type="button" data-action="add-item">
                                <i class="fa fa-plus-square" aria-hidden="true"></i>
                            </button>
                        </div>
                    </div>
                    <ol>
                        {{#each itemsByType.shield}}
                        <li class="draggable" data-item-id="{{this._id}}">
                            <img width="32" height="32" src="{{{this.img}}}">
                            <label>{{this.name}} <button class="button-inline" type="button"
                                    data-action="toggle-equipped">
                                    <i class="fa {{#if this.data.equipped}}fa-toggle-on{{else}}fa-toggle-off{{/if}}"
                                        aria-hidden="true"></i>
                                </button></label>
                            <div class="defense-bonus">{{this.data.defenseBonus}}</div>
                            <div class="tick-malus">{{this.data.tickMalus}}</div>
                            <div class="handicap">{{this.data.handicap}}</div>
                            <div class="features">{{this.data.features}}</div>
                            <div class="load">{{this.data.load}}</div>
                            <div class="actions">
                                <button class="button-inline" type="button" data-action="edit-item">
                                    <i class="fa fa-edit" aria-hidden="true"></i>
                                </button>
                                <button class="button-inline" type="button" data-action="delete-item">
                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                </button>
                            </div>
                        </li>
                        {{/each}}
                    </ol>
                </div>
                <div class="list inventory" data-item-type="equipment">
                    <div class="list-header">
                        <h3>{{localize "splittermond.equipment"}}</h3>
                        <div class="qty">{{localize "splittermond.qty"}}</div>
                        <div class="load">{{localize "splittermond.load"}}</div>
                        <div class="actions">
                            <button class="button-inline" type="button" data-action="add-item">
                                <i class="fa fa-plus-square" aria-hidden="true"></i>
                            </button>
                        </div>
                    </div>
                    <ol>
                        {{#each itemsByType.equipment}}
                        <li class="draggable" data-item-id="{{this._id}}">
                            <img width="32" height="32" src="{{{this.img}}}">
                            <label>{{this.name}}</label>
                            <div class="qty">{{this.data.quantity}}</div>
                            <div class="load">{{this.data.weight}}</div>
                            <div class="actions">
                                <button class="button-inline" type="button" data-action="edit-item">
                                    <i class="fa fa-edit" aria-hidden="true"></i>
                                </button>
                                <button class="button-inline" type="button" data-action="delete-item">
                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                </button>
                            </div>
                        </li>
                        {{/each}}
                    </ol>
                </div>
            </div>
        </section>
        <section class="tab status" data-group="primary" data-tab="status">
            <div class="damage">
                <div class="list">
                    <div class="list-header">
                        <h3>{{localize "splittermond.channeledDamage"}}</h3>
                        <div class="actions">
                            <button class="button-inline" type="button" data-action="add-channeled-health"
                                data-render-sheet="0">
                                <i class="fa fa-plus-square" aria-hidden="true"></i>
                            </button>
                        </div>
                    </div>
                    <ol data-array="data.health.channeled.entries">
                        {{#each data.health.channeled.entries}}
                        <li data-index="{{@index}}">
                            <input data-array-field="description" type="text" value="{{this.description}}">

                            <div class="costs"><input data-array-field="costs" type="text" value="{{this.costs}}"
                                    data-dtype="Number"></div>
                            <div class="actions">
                                <button class="button-inline" type="button" data-action="delete-array-element">
                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                </button>
                            </div>
                        </li>
                        {{/each}}
                    </ol>
                </div>

            </div>
        </section>
    </main>

</form>